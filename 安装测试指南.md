# Chrome扩展安装和测试指南

## 问题说明

如果您在测试页面看到"Chrome扩展API不可用"的错误信息，这是因为：

1. **直接打开HTML文件**：通过 `file://` 协议直接打开HTML文件时，Chrome扩展无法注入content script
2. **扩展未安装**：Chrome扩展需要先安装到浏览器中才能工作
3. **页面协议限制**：Chrome扩展只能在 `http://` 或 `https://` 协议下工作

## 正确安装和测试步骤

### 第一步：安装Chrome扩展

1. **打开Chrome浏览器**
2. **访问扩展管理页面**：
   - 在地址栏输入：`chrome://extensions/`
   - 或者：菜单 → 更多工具 → 扩展程序

3. **开启开发者模式**：
   - 在页面右上角找到"开发者模式"开关
   - 点击开启

4. **加载扩展**：
   - 点击"加载已解压的扩展程序"按钮
   - 选择项目文件夹：`/Users/fwmh/transition-extension`
   - 点击"选择文件夹"

5. **确认安装**：
   - 扩展应该出现在扩展列表中
   - 确保扩展已启用（开关为蓝色）

### 第二步：启动本地服务器

**方法一：使用Python**
```bash
cd /Users/fwmh/transition-extension
python -m http.server 8000
```

**方法二：使用Node.js**
```bash
cd /Users/fwmh/transition-extension
npx serve . -p 8000
```

**方法三：使用其他工具**
- Live Server (VS Code扩展)
- http-server (npm包)
- 任何其他本地服务器

### 第三步：访问测试页面

1. **在浏览器中访问**：
   ```
   http://localhost:8000/test_translate.html
   ```

2. **检查扩展状态**：
   - 页面右上角会显示"扩展状态检测"面板
   - 应该看到"✓ Chrome扩展API可用"
   - 应该显示扩展ID

3. **测试翻译功能**：
   - 将鼠标悬浮在任何英文文本上
   - 应该会显示中文翻译提示框
   - 点击右下角的"测试翻译功能"按钮进行自动测试

## 故障排除

### 问题1：仍然显示"Chrome扩展API不可用"

**可能原因：**
- 扩展未正确安装
- 页面仍通过 `file://` 协议访问
- 扩展被禁用

**解决方案：**
1. 检查 `chrome://extensions/` 确认扩展已安装并启用
2. 确保通过 `http://localhost:8000/test_translate.html` 访问页面
3. 刷新页面或重新加载扩展

### 问题2：没有翻译提示框出现

**可能原因：**
- Content script未注入
- 翻译字典加载失败
- JavaScript错误

**解决方案：**
1. 打开浏览器开发者工具（F12）
2. 查看Console标签页的错误信息
3. 检查Network标签页确认 `translation-dict.json` 是否加载成功
4. 查看"扩展状态检测"面板的详细信息

### 问题3：翻译字典加载失败

**可能原因：**
- `translation-dict.json` 文件不存在或格式错误
- 文件路径问题

**解决方案：**
1. 确认 `translation-dict.json` 文件存在
2. 检查JSON格式是否正确
3. 查看Network标签页的加载状态

## 调试技巧

### 1. 查看扩展日志
- 在 `chrome://extensions/` 页面点击扩展的"详细信息"
- 点击"检查视图"查看background script日志
- 在测试页面按F12查看content script日志

### 2. 使用测试页面的调试功能
- **状态检测面板**：显示扩展API状态、协议信息等
- **自动测试按钮**：自动测试多个元素的翻译功能
- **控制台日志**：详细的调试信息

### 3. 手动测试
- 悬浮在不同类型的元素上（按钮、链接、文本等）
- 测试不同长度的文本
- 测试特殊字符和标点符号

## 常见错误信息

| 错误信息 | 原因 | 解决方案 |
|---------|------|----------|
| "Chrome扩展API不可用" | 扩展未安装或页面协议错误 | 安装扩展并使用HTTP协议访问 |
| "无法与后台脚本通信" | Background script未运行 | 检查background.js文件 |
| "加载翻译字典失败" | JSON文件问题 | 检查translation-dict.json文件 |
| "Content Script状态未知" | Content script注入问题 | 检查manifest.json配置 |

## 成功标志

当一切正常工作时，您应该看到：

1. ✅ 扩展状态检测面板显示"Chrome扩展API可用"
2. ✅ 显示扩展ID
3. ✅ Content Script已注入
4. ✅ 鼠标悬浮英文文本时显示中文翻译
5. ✅ 控制台无错误信息
6. ✅ 自动测试找到翻译提示

如果所有项目都显示正常，说明扩展工作正常！
