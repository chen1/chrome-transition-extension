<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iframe文本段翻译测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 2px solid #007bff;
            border-radius: 5px;
        }
        .medType {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px 0;
            background-color: #f9f9f9;
        }
        iframe {
            width: 100%;
            height: 300px;
            border: 2px solid #28a745;
            border-radius: 5px;
        }
        .instructions {
            background-color: #e7f3ff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>iframe文本段翻译测试页面</h1>
    
    <div class="instructions">
        <h3>测试说明：</h3>
        <ol>
            <li>确保浏览器扩展已加载</li>
            <li>将鼠标悬停在下面iframe内的测试元素上</li>
            <li>检查是否显示中文翻译tooltip（绿色边框表示文本段翻译）</li>
            <li>打开开发者工具查看控制台日志</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>测试1: iframe内部的混合节点结构</h2>
        <iframe id="testIframe" src="data:text/html;charset=utf-8,
<!DOCTYPE html>
<html>
<head>
    <meta charset='UTF-8'>
    <title>iframe内部测试</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .medType { border: 1px solid #ccc; padding: 10px; margin: 10px 0; background-color: #f9f9f9; }
    </style>
</head>
<body>
    <h3>iframe内部测试页面</h3>
    <div class='medType'>
        <!-- 国际化原值: HM001707=初诊 -->
        <input name='times' type='radio' id='times1' checked='checked' value='初诊' onclick='checkDtminType()' disabled='disabled'>Initial Visit
        <!-- 国际化原值: HM002767=复诊 -->
        <input name='times' type='radio' id='times2' value='复诊' onclick='checkDtminType()' disabled='disabled'>Follow-Up Visit
    </div>
    <div class='medType'>
        <span>Patient Type: </span>
        <input name='patient' type='radio' id='patient1' value='new'>Initial Visit
        <input name='patient' type='radio' id='patient2' value='return'>Follow-Up Visit
        <span> - Please select one</span>
    </div>
    <script>
        function checkDtminType() {
            console.log('iframe内checkDtminType called');
        }
    </script>
</body>
</html>"></iframe>
    </div>

    <div class="test-section">
        <h2>测试2: 主窗口的混合节点结构（对比）</h2>
        <div class="medType">
            <!-- 国际化原值: HM001707=初诊 -->
            <input name="times" type="radio" id="times1" checked="checked" value="初诊" onclick="checkDtminType()" disabled="disabled">Initial Visit
            <!-- 国际化原值: HM002767=复诊 -->
            <input name="times" type="radio" id="times2" value="复诊" onclick="checkDtminType()" disabled="disabled">Follow-Up Visit
        </div>
    </div>

    <script>
        function checkDtminType() {
            console.log('主窗口checkDtminType called');
        }
        
        // 添加一些调试信息
        console.log('主测试页面加载完成');
        console.log('页面元素数量:', document.querySelectorAll('*').length);
        console.log('iframe元素数量:', document.querySelectorAll('iframe').length);
        
        // 检查TextSegmentTranslator是否可用
        if (typeof TextSegmentTranslator !== 'undefined') {
            console.log('TextSegmentTranslator可用');
        } else {
            console.log('TextSegmentTranslator不可用');
        }
        
        // 监听iframe加载完成
        document.getElementById('testIframe').addEventListener('load', function() {
            console.log('测试iframe加载完成');
            try {
                const iframeDoc = this.contentDocument || this.contentWindow.document;
                console.log('iframe文档元素数量:', iframeDoc.querySelectorAll('*').length);
                console.log('iframe内medType元素数量:', iframeDoc.querySelectorAll('.medType').length);
            } catch (e) {
                console.log('无法访问iframe内容（跨域限制）:', e.message);
            }
        });
    </script>
</body>
</html>
